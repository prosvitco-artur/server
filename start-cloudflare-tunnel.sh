#!/bin/bash

echo "üåê –ó–∞–ø—É—Å–∫ Cloudflare Tunnel –¥–ª—è WebSocket —Å–µ—Ä–≤–µ—Ä–∞"
echo "================================================="

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ WebSocket —Å–µ—Ä–≤–µ—Ä
if ! pgrep -f "websocket-server.php" > /dev/null; then
    echo "‚ö†Ô∏è  WebSocket —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ!"
    echo "üìù –°–ø–æ—á–∞—Ç–∫—É –∑–∞–ø—É—Å—Ç—ñ—Ç—å: php websocket-server.php --dev"
    exit 1
fi

echo "‚úÖ WebSocket —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞—Ü—é—î –Ω–∞ localhost:8080"
echo "üöÄ –°—Ç–≤–æ—Ä—é—é Cloudflare —Ç—É–Ω–µ–ª—å..."

# –ó–∞–ø—É—Å–∫ —Ç–∏–º—á–∞—Å–æ–≤–æ–≥–æ —Ç—É–Ω–µ–ª—é (–Ω–µ –ø–æ—Ç—Ä–µ–±—É—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–º–µ–Ω—É)
cloudflared tunnel --url http://localhost:8080

echo "üîó –¢—É–Ω–µ–ª—å —Å—Ç–≤–æ—Ä–µ–Ω–æ! –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –Ω–∞–¥–∞–Ω—É URL –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è."
echo "‚ö†Ô∏è  –¶–µ —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ç—É–Ω–µ–ª—å - URL –∑–º—ñ–Ω–∏—Ç—å—Å—è –ø—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É."